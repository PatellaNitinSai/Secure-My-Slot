<app-navbar></app-navbar>

<div class="booking-container" style="background: linear-gradient(135deg, #000000 40%, #ffffff 40%);">

  <div class="booking-header">
    <button mat-button routerLink="/slot-categories" class="back-btn" aria-label="Go back">
      <mat-icon>arrow_back</mat-icon>
      <span>Go Back</span>
    </button>

    <h1>Secure Your Slot</h1>
    <p>Select your preferred time slot</p>
  </div>

  <!-- Duration Selection -->
  <div class="duration-section" style="background: transparent;">
    <label for="duration" style="color: white;">How long do you need?</label>
    <select
      id="duration"
      [(ngModel)]="bookingDetails.duration"
      (ngModelChange)="generateTimeSlots($event)"
      class="duration-select"
    >
      <option [value]="1">1 Hour</option>
      <option [value]="2">2 Hours</option>
      <option [value]="3">3 Hours</option>
      <option [value]="4">4 Hours</option>
    </select>
  </div>

  <!-- Date Selection -->
  <div class="date-section" style="background: transparent;">
    <label for="date" style="color: white;">Select Date</label>
    <input
      type="date"
      id="date"
      [(ngModel)]="bookingDetails.date"
      (ngModelChange)="onDateChange($event)"
      [min]="today"
      class="date-input"
    />
  </div>

  <div class="slots-section" style="background: transparent;">
    <h2 style="color: white;">Available Time Slots</h2>

    <div class="truck-container">
      <img src="/assets/svg/truck_819438.svg" alt="truck" class="truck-bg" />
      <div class="truck-overlay slots-grid" role="list" aria-label="Available time slots" style="width:785px; padding-bottom: 10px;">
        <button
          *ngFor="let slot of timeSlots"
          type="button"
          class="slot-box"
          [class.available]="slot.isAvailable"
          [class.unavailable]="!slot.isAvailable"
          [class.selected]="slot.isSelected"
          (click)="selectSlot(slot)"
          [disabled]="!slot.isAvailable"
          role="listitem"
          [attr.aria-pressed]="slot.isSelected"
        >
          <div class="slot-time">
            <span class="start-time">{{ slot.startTime }}</span>
            <span class="separator">â†’</span>
            <span class="end-time">{{ slot.endTime }}</span>
          </div>
          <div class="slot-status">
            <span *ngIf="slot.isSelected">Selected</span>
            <span *ngIf="!slot.isSelected && slot.isAvailable">Available</span>
            <span *ngIf="!slot.isAvailable">Booked</span>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Booking Details Form -->
  <div class="details-section" *ngIf="bookingDetails.selectedSlot" style="background: transparent;">
    <h2 style="color: white;">Your Details</h2>

    <!-- use ngSubmit for form handling -->
    <form class="booking-form" (ngSubmit)="confirmBooking($event)">

      <div class="form-group">
        <label for="name" style="color: white;">Full Name *</label>
        <input
          type="text"
          id="name"
          name="name"
          [(ngModel)]="bookingDetails.name"
          placeholder="Enter your full name"
          required
        />
      </div>

      <div class="form-group">
        <label for="email" style="color: white;">Email Address *</label>
        <input
          type="email"
          id="email"
          name="email"
          [(ngModel)]="bookingDetails.email"
          placeholder="your.email@daimler.co"
          required
        />
      </div>

      <!-- HIL selection -->
      <div class="form-group">
        <label for="hil" style="color: white;">Select HIL *</label>
        <select
          id="hil"
          name="hil"
          required
          [(ngModel)]="bookingDetails.hil"
          (ngModelChange)="onHilChange($event)"
        >
          <option value="" disabled>Select HIL</option>
          <option *ngFor="let opt of hilOptions" [value]="opt">{{ opt }}</option>
          <option value="OTHER">OTHER</option>
        </select>
      </div>

      <!-- Other reason input (shown only when OTHER selected) -->
      <div class="form-group" *ngIf="isOtherSelected">
        <label for="otherReason" style="color: white;">Please specify reason *</label>
        <input
          id="otherReason"
          name="otherReason"
          type="text"
          placeholder="Enter reason"
          [(ngModel)]="bookingDetails.otherReason"
          required
        />
      </div>

      <!-- Booking Summary -->
      <div class="booking-summary">
        <h3 style="color: white;">Booking Summary</h3>
        <div class="summary-item">
          <span class="label" style="color: #ddd;">Date:</span>
          <span class="value" style="color: #fff;">{{ bookingDetails.date | date:'fullDate' }}</span>
        </div>
        <div class="summary-item">
          <span class="label" style="color: #ddd;">Time:</span>
          <span class="value" style="color: #fff;">{{ bookingDetails.selectedSlot.startTime }} - {{ bookingDetails.selectedSlot.endTime }}</span>
        </div>
        <div class="summary-item">
          <span class="label" style="color: #ddd;">Duration:</span>
          <span class="value" style="color: #fff;">{{ bookingDetails.duration }} Hour(s)</span>
        </div>
      </div>

      <button type="submit" class="submit-btn">
        Confirm Booking
      </button>
    </form>
  </div>
</div>

<app-footer></app-footer>
